<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../ScriptPaths.xsl"?>

  <!-- DE- Open an existing Dictionarty Express project -->
<accil on-fail="assert">

   <bug id="TBD" desc="TBD"/>

   <!--sound frequency="400" duration="500"/-->

	<on-application run="ok" title="Publishing Solutions 1.0">

		<!-- Open the scripture file -->
		<include from="testPath.xml"/>
		<var id="lbl" set="Scripture"/>
		<var id="fi" set="ScrSet"/>
		<var id="oldcss" set="scripture.css"/>
		<var id="newcss" set="scripture-scripture1.css"/>
	
		<click select="toolbar/open-project"/>
		<on-dialog wait="1000" title="Open" >
			<click path="9:File name:[2]/9:File name:/46:File name:"/>
			<insert>$testPath;\Output\ScrSet\ScrSet.de</insert>
			<click path="9:Open/43:Open"/>
		</on-dialog>
	
		<!-- If a modified css file exists. delete it and reset the default css file to Sena 3a.css --> 
		<model select="new-project[@role='view']" log = "all" >
			<glimpse id="filexists" select="file-test-css" expect="$newcss" on-fail="skip" />

			<if>
				<condition of="$filexists" is="true"/>
				<then>
					 <!-- We need to delete the file name since it already exists --> 
					<click select="file-test-css" side="right" />
					<insert wait="200">{DOWN 1}~</insert>"/>
					 <!-- We might get an error message, so press enter --> 
					<insert wait="50">{ENTER}</insert>
					<!--  Reset the default css file to be Sena 3a.css --> 
					<click select="file-after-css" side="right" />
					<insert wait="200">{DOWN 4}~</insert>"/>
				</then>
			</if>
		</model>

		<!-- Open the scripture options dialog -->
		<click log="all" select="toolbar/ptype-settings"/>

		<model select="scripture-options[@role='dialog']">
			<on-dialog title="$newcss">			<!-- Update the values on the Basics Tab -->
				
				<click select="basics/tab"/>

				<!-- Set values on the basics tab -->
				<click select="basics/font-name"/>
				<insert wait="50">{DOWN 7}~</insert>"/>   <!-- To get to Arial -->
				
				<click select="basics/font-style"/>
				<insert wait="50">{DOWN 7}~</insert>"/>   <!-- To get to Arial -->
				
				<click select="basics/font-size-value"/>
				<insert>14</insert>"/>                     <!-- Set the font size to 14 -->
				
				<click select="basics/line-space-value"/>
				<insert>15</insert>"/>                      <!-- Leading Spaces is 15 -->
				
				<click select="basics/justify-para"/>      <!-- Turn on the justify paragraphs checkbox -->
				
				<click select="basics/page-size"/>
				<insert wait="50">{DOWN 1}~</insert>"/>   <!-- To get to Custom -->
				
				<click select="basics/height-value"/>
				<insert wait="50">{END}{BACKSPACE 6}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert>14in</insert>"/>                      <!-- Height is 14in -->
				
				<click select="basics/width-value"/>
				<insert wait="50">{END}{BACKSPACE 6}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>9in</insert>"/>                         <!-- Height is 9 in -->
				
				<click select="basics/paper-size"/>
				<insert wait="50">{UP 1}~</insert>"/>       <!-- Paper Size is A4 -->
				
				<click select="basics/crop-marks"/>          <!-- Turn on the crop marks checkbox -->
				
				<click select="basics/inside-value"/>
				<insert wait="50">{BACKSPACE 3}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>.5in</insert>"/>                      <!-- Set inside margin to 1/2" -->
				
				<click select="basics/outside-value"/>
				<insert wait="50">{BACKSPACE 3}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>1in</insert>"/>						 <!-- Set outside margin to 1" -->
				
				<click select="basics/top-value"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>1.25in</insert>"/>                     <!-- Set top margin to 1.5in -->
				
				<click select="basics/bottom-value"/>
				<insert wait="50">{BACKSPACE 3}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>.75in</insert>"/>                       <!-- Set bottom margin to 2in -->
				
				<click select="basics/column-value"/>
				<insert wait="50">{DOWN 1}~</insert>"/>      <!-- Number of columns -->
				
				<click select="basics/gutter-width-value"/>
				<insert>1in</insert>"/>                       <!-- Gutter width is 1 in -->
								
				<click select="basics/vertical-rule"/>  <!-- Turn on the verticle rule checkbox -->
				
				<click select="next" />
				
				<!-- Set values on the Chapter/Verse tab -->
				<click select="chapter-verse/gutter-width"/>
				<insert>3</insert>"/>                     <!-- Set the gutter width (Chapter Numbers) to 3 -->
				
				<click select="chapter-verse/pos-numbers/value"/>
				<insert wait="50">{DOWN 1}~</insert>"/>  <!-- To get to Inline -->
				
				<click select="chapter-verse/chapter-string-value"/>
				<insert>5</insert>"/>                     <!-- Set the Chapter String to 5 -->
				
				<click select="chapter-verse/position-string-value"/>
				<insert>6</insert>"/>                     <!-- Set the Position string to 6 -->
				
				<click select="chapter-verse/bold"/>   <!-- Turn off the bold checkbox -->
				
				<click select="chapter-verse/raised"/> <!-- Turn off the raised checkbox -->
				
				<click select="chapter-verse/include-verse-number-1"/> <!-- Turn on this checkbox too -->
				
				<click select="next" />
				
				<!-- Set values on the Headings tab -->
				<click select="headings/verse-number-format"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>10pt</insert>"/>                     <!-- Set the Verse Number Format to 10 pt -->
				
				<click select="headings/font-style-value/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>  <!-- To get to Font Style Italic -->
				
				<click select="headings/centered-value"/> <!-- Turn on the centered checkbox -->
				
				<click select="headings/font-size-value"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>10pt</insert>"/>                     <!-- Set the Font Size value to 12 -->
				<click select="headings/line-spacing-leading-value"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>10pt</insert>"/>                     <!-- Set the Line Spacing (Leading) value to 10 -->
				<click select="headings/space-before-value"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>20pt</insert>"/>                     <!-- Set the Space Before value to 20 -->
				<click select="headings/space-after-value"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>20pt</insert>"/>                     <!-- Set the Space After value to 20 -->
				
				<click select="headings/font-style-value2/value"/>
				<insert wait="50">{DOWN 1}~</insert>"/>  <!-- To get to Font Style Bold -->
				
				<click select="headings/space-after4"/> <!-- Turn on the centered checkbox -->
				
				<click select="headings/font-size-value2"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>12pt</insert>"/>                     <!-- Set the Font Size value to 12 -->
				<click select="headings/line-spacing-leading-value2"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>13pt</insert>"/>                     <!-- Set the Line Spacing (Leading) value to 10 -->
				<click select="headings/space-before-value2"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>20pt</insert>"/>                     <!-- Set the Space Before value to 20 -->
				<click select="headings/space-after-value2"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>20pt</insert>"/>                     <!-- Set the Space After value to 20 -->
				<click select="headings/font-style-value4/value"/>
				<insert wait="50">{DOWN 1}~</insert>"/>  <!-- To get to Reference Font Style Bold -->
				<click select="headings/font-size-value4"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>12pt</insert>"/>                     <!-- Set the Font Size value to 12 -->
				
				<click select="headings/font-style-value3/value"/>
				<insert wait="50">{DOWN 3}~</insert>"/>  <!-- To get to Font Style Bold -->
				
				<click select="headings/centered-value3"/> <!-- Turn on the centered checkbox -->
				
				<click select="headings/font-size-value3"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>12pt</insert>"/>                     <!-- Set the Font Size value to 12 -->
				<click select="headings/line-spacing-leading-value3"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>14pt</insert>"/>                     <!-- Set the Line Spacing (Leading) value to 10 -->
				<click select="headings/space-before-value3"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>20pt</insert>"/>                     <!-- Set the Space Before value to 20 -->
				<click select="headings/space-after-value3"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>20pt</insert>"/>                     <!-- Set the Space After value to 20 -->	
				
				<click select="next" />
				
				<!-- Set values on the Footnotes tab -->
				<click select="footnotes/space-after"/>
				<insert>10pt</insert>"/>                     <!-- Set the Font Size for Notes to 10 pt -->
				<click select="footnotes/space-after-value"/>
				<insert wait="50">{BACKSPACE 2}</insert>"/>  <!-- Backspace over the previouus contents -->
				<insert wait="50">{DELETE 3}</insert>"/>     <!-- Backspace over the previouus contents -->
				<insert>10pt</insert>"/>                     <!-- Set the Line Spacing for Notes to 10 pt -->
				
				<click select="footnotes/footnote-caller-fs-value/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>  <!-- To set Footnote Caller Font Style to Italic -->
				<click select="footnotes/cross-ref-caller-fs-value/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>  <!-- To set Cross Reference Footnote Caller Font Style to Italic -->
				<click select="footnotes/inside-value/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>  <!-- To set Font Style to Italic -->
				<click select="footnotes/font-style-value/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>  <!-- To set Footnote Caller Font Style to Italic -->
				
				<click select="next" />
				
				<!-- Set values on the text-spacing tab -->
				<click select="text-spacing/style"/>
				<insert>2pt</insert>"/>                     <!-- Set the optimal font between words to 2 pt -->
				<click select="text-spacing/desired-opt-val"/>
				<insert>4pt</insert>"/>                     <!-- Set the Line Spacing for Notes to 10 pt -->
				
				<click select="next" />
				
				<!-- Set values on the 'Other' tab -->
				<click select="other/table-header-font-style/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>           <!-- Set Table Headers Font Style to Italic -->
				<click select="other/ref-loc-val/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>    <!-- Set Reference Location to Top Left -->
				<click select="other/page-num-val/value"/>
				<insert wait="50">{DOWN 2}~</insert>"/>    <!-- Set Page Number Location to Bottom Center -->
				<click select="other/font-size-val"/>		
				<insert>12pt</insert>"/>                    <!-- Set Font Size to 12pt -->
				<click select="other/cvs-value"/>		
				<insert>:</insert>"/>                    <!-- Set Chapter Verse Separator to : -->
				<click select="other/conseq-ref-seq-sep-value"/>		
				<insert>-</insert>"/>                    <!-- Set Consecutive Reference Separatorto - -->
				<click select="other/non-conseq-ref-sep-value"/>		
				<insert>,</insert>"/>                    <!-- Set Non-consecutive Reference Sep to , -->
				
				<click select="other/ref-format/value"/>
				<insert wait="50">{DOWN 2}~</insert> <!--  Set Scripture Reference Format to  -->
				
				<click select="save" />

			<!-- Save the scripture options dialog that we've modified -->
			<on-dialog title="Save As" path="9:@title;" >
				<click path="9:Save/43:Save"/>
			</on-dialog>

			<click select="done"/>
			</on-dialog>

		</model>

		<!--model select="new-project[@role='view']">
			<click select="file-test-css"/>
			<!- So the new css file is displayed ->

			<!- Validate the values on the basics tab ->
			<glimpse id="verify2" select="css-pane" path="/value:rexp#-ps-basicsLastBook-string:/.John/." on-fail="assert" />
			<glimpse id="verify3" select="css-pane" path="/value:rexp#font-family:/.Ariel/." on-fail="assert" />
			<glimpse id="verify4" select="css-pane" path="/value:rexp#font-style:Bold" on-fail="assert" />
			<glimpse id="verify5" select="css-pane" path="/value:rexp#font-size:14pt" on-fail="assert" />
			<glimpse id="verify6" select="css-pane" path="/value:rexp#line-height:15pt" on-fail="assert" />
			<glimpse id="verify7" select="css-pane" path="/value:rexp#text-align:justify" on-fail="assert" />
			<glimpse id="verify8" select="css-pane" path="/value:rexp#size: 9in 14in" on-fail="assert" />
			<glimpse id="verify9" select="css-pane" path="/value:rexp#margin: 1.25in 1in .75in .5in" on-fail="assert" />
			<glimpse id="verify10" select="css-pane" path="/value:rexp#marks:crop cross" on-fail="assert" />
			<glimpse id="verify11" select="css-pane" path="/value:rexp#counter-increment: page" on-fail="assert" />
			<glimpse id="verify12" select="css-pane" path="/value:rexp#column-count: 2; -moz-column-count: 2" on-fail="assert" />
			<glimpse id="verify13" select="css-pane" path="/value:rexp#column-gap: 1in; -moz-column-gap: 1in" on-fail="assert" />
			<glimpse id="verify14" select="css-pane" path="/value:rexp#column-rule: solid 1pt #aa0000" on-fail="assert" />
			<glimpse id="verify15" select="css-pane" path="/value:rexp#column-fill: balance" on-fail="assert" />
			<glimpse id="verify16" select="css-pane" path="/value:rexp#text-align: left" on-fail="assert" />
			
			<!- Validate the values on the Chapter/Verse tab ->
			<glimpse id="chapverse1" select="css-pane" path="/value:rexp#-ps-positionchapternumbers-string: /.Inline/." on-fail="assert" />
			<glimpse id="chapverse2" select="css-pane" path="/value:rexp#-ps-chapterstring-string: /.5/." on-fail="assert" />
			<glimpse id="chapverse3" select="css-pane" path="/value:rexp#-ps-chapterpositionstring-string: /.6/." on-fail="assert" />
			<glimpse id="chapverse4" select="css-pane" path="/value:rexp#-ps-IncludeVersenumber-string: /.True/." on-fail="assert" />

			<!- Validate the values on the Other tab ->
			<glimpse id="other1" select="css-pane" path="/value:rexp#-ps-TableHeadersFontStyle-string:/.Italic/." on-fail="assert" />
			<glimpse id="other2" select="css-pane" path="/value:rexp#-ps-IncludeVerseInHeaderReferences-string:/.yes/." on-fail="assert" />
			<glimpse id="other3" select="css-pane" path="/value:rexp#ps-NonConsecutiveReferenceSeparator-string:/.1/." on-fail="assert" />
			<glimpse id="other4" select="css-pane" path="/value:rexp#content: string/.bookx, start/. /. /. string/.chapterx, start/. /.1/. string(versex, start/. /.1/. string(chapterx, last/. /.1/. string/.versex, last/." on-fail="assert" />
			<glimpse id="other5" select="css-pane" path="/value:rexp#font-size: 12pt" on-fail="assert" />

			<!- Validate the values on the footnote tab ->
			<glimpse id="footnote1" select="css-pane" path="/value:rexp#footnote /. font-size:10pt; line-height:10pt; list-style-position: none; font-style:Italic; /." on-fail="assert" />
			<glimpse id="footnote2" select="css-pane" path="/value:rexp#footnote::footnote-call /. font-style:Italic; /." on-fail="assert" />
			<glimpse id="footnote3" select="css-pane" path="/value:rexp#crossReference::footnote-call /. font-style:Italic; /." on-fail="assert" />

		</model-->

		<click select="toolbar/exit"/>
	</on-application>

  <!--sound frequency="1000" duration="500"/-->

</accil>

