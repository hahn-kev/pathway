<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../ScriptPaths.xsl"?>

  <!-- DE - Create a new DictionaryExpress project -->
<accil on-fail="assert">

   <bug id="TBD" desc="TBD"/>

   <!--sound frequency="400" duration="500"/-->

   <on-application run="ok" title="Publishing Solutions 1.0">

      <include from="testPath.xml"/>
      <var id="new" set="rexp#New.*"/>
      <click log="all" select="menubar/file/new"/>
      <on-dialog wait="1000" name="NewProject" title="New Project" path="9:NewProject/" >
         <click path="9:btnXHTMLBrowse/43:btnXHTMLBrowse"/>
         <on-dialog title="Open">
            <click path="9:File name:[2]/9:File name:/46:File name:/9:File name:/42:File name:"/>
            <insert>$testPath;\Input\NewScr\TeTest.xhtml</insert>
            <click path="9:Open/43:Open"/>
         </on-dialog>
         <insert>{tab}{tab}</insert>
         <insert wait="500" pause="10">$testPath;\Output</insert>
         <insert>%o</insert>
      </on-dialog>
      
      <var id="formName" set="Converter" />
      <var id="labelName" set="lblProjectType"/>
      <var id="titleValue" set="rexp#Scripture\d"/>
      <model select="new-project[@role='view']" log="all">
         <glimpse id="NewIt" select="titlename" expect="$titleValue" on-fail="assert"/>
         <glimpse id="NewIt2" select="titletype" expect="$titleValue" on-fail="assert"/>
      </model>
      <!-- Close the Scripture file. -->
      <click select="menubar/close"/>

      <!-- Open a Dictionary file and verify that the dialog indicates dictionary -->
      <click select="toolbar/new"/>

      <on-dialog name="NewDictionary" title="New Dictionary" path="9:NewDictionary/" >
         <click path="9:txtXHTML/42:txtXHTML"/>
         <insert>$testPath;\Input\NewDic\main.xhtml</insert>
         <insert>{tab 2}$testPath;\Output%o</insert>
      </on-dialog>

      <var id="formName" set="Converter" />
      <var id="labelName" set="lblProjectType"/>
      <var id="titleValue" set="rexp#Dictionary\d"/>
      <model select="new-project[@role='view']" log="all">
         <glimpse id="NewIt3" select="titlename" expect="$titleValue" on-fail="assert"/>
         <glimpse id="NewIt4" select="titletype" expect="$titleValue" on-fail="assert"/>
      </model>
      <!-- Close the Dictionary file. -->
      <click select="menubar/file/exit"/>

   </on-application>

   <!--sound frequency="400" duration="500"/-->

</accil>
